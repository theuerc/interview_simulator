# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/introduction/learn-gitpod/gitpod-yaml)
# and commit this file to your remote git repository to share the goodness with others.

# Learn more from ready-to-use templates: https://www.gitpod.io/docs/introduction/getting-started/quickstart

tasks:
  - name: Prepare development environment
    before: |
      touch dev.db
      cp .env.example .env
      python shell_scripts/add_secret_json.py "$GOOGLE_JSON_FILENAME" "$GOOGLE_JSON_VALUE"
      sed -i "s/\[OPENAI_API_KEY\]/$OPENAI_API_KEY/" .env
      sed -i "s/\[PATH/TO/GOOGLE/KEY.JSON\]/$GOOGLE_JSON_FILENAME/" .env
    init: |
      sudo apt-get update
      sudo apt-get install sqlite3 libsqlite3-dev -y
      pipenv install --dev
      pipenv shell
      flask db upgrade
      npm install
      npm run-script build
    command: |
      npm start
    
  - name: Terminal
    command: |
      echo 'use this shell'

vscode:
  extensions:
    - ms-python.python
    - yzhang.markdown-all-in-one
    - eamodio.gitlens
    - lextudio.restructuredtext

github:
  prebuilds:
    # enable for main/default branch
    main: true
    # enable for other branches (defaults to false)
    branches: true
    # enable for pull requests coming from this repo (defaults to true)
    pullRequests: true
    # enable for pull requests coming from forks (defaults to false)
    pullRequestsFromForks: true
    # add a check to pull requests (defaults to true)
    addCheck: true
    # add a "Review in Gitpod" button as a comment to pull requests (defaults to false)
    addComment: true
    # add a "Review in Gitpod" button to the pull request's description (defaults to false)
    addBadge: true
    # add a label once the prebuild is ready to pull requests (defaults to false)
    addLabel: true